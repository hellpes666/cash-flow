generator client {
  provider = "prisma-client-js"
  output   = "./generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTRGES_URI")
}

model Test {
  id String @id @default(uuid())

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
}

model User {
  id String @id @default(uuid())

  email    String @unique
  password String

  bankAccounts BankAccount[] @relation("user_bank_accounts")
  userGoals    UserGoal[]    @relation("user_goals")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("users")
}

model UserGoal {
  id String @id @default(uuid())

  name      String?
  goalValue Int      @map("goal_value")
  startDate DateTime @map("start_date")
  endDate   DateTime @map("end_date")
  comment   String?

  userId String @map("user_id")
  user   User   @relation("user_goals", fields: [userId], references: [id])

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("user_goals")
}

model BankAccount {
  id String @id @default(uuid())

  name    String
  type    BankAccountType @default(BANK)
  balance Int             @default(0)

  transactions TransactionAction[]

  userId String @map("user_id")
  user   User   @relation("user_bank_accounts", fields: [userId], references: [id])

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("bank_accounts")
}

model TransactionAction {
  id String @id @default(uuid())

  userId String
  value  Int

  comment String?

  type TransactionType

  categoryId String?              @default("") @map("category_id")
  category   TransactionCategory? @relation(fields: [categoryId], references: [id])

  tagId String?         @default("") @map("tag_id")
  tag   TransactionTag? @relation(fields: [tagId], references: [id])

  bankAccountId String      @map("bank_account_id")
  bankAccount   BankAccount @relation(fields: [bankAccountId], references: [id])

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("transaction_actions")
}

model TransactionCategory {
  id String @id @default(uuid())

  name  String
  icon  String?
  color String?

  actions TransactionAction[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("transaction_categories")
}

model TransactionTag {
  id String @id @default(uuid())

  name String

  actions TransactionAction[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("transaction_tags")
}

enum TransactionType {
  income
  expense

  @@map("transaction_types")
}

enum BankAccountType {
  BANK
  CASH

  @@map("bank_account_types")
}
